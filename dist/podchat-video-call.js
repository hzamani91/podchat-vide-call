!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VideoCall=t():e.VideoCall=t()}(self,(function(){return(()=>{"use strict";var e={887:(e,t,n)=>{n.r(t),n.d(t,{callType:()=>s,callStatus:()=>i,callEvents:()=>l,messageEvents:()=>a,messageType:()=>o,callDisplayType:()=>r,socketStateType:()=>c});const s={VOICE:"VOICE",VIDEO:"VIDEO"},i={DEFAULT:"DEFAULT",CALLING:"CALLING",CALLCONFIRM:"CALLCONFIRM",CALLSTREAM:"CALLSTREAM",MESSAGE:"MESSAGE",POOR_CONNECTION:"POOR_CONNECTION"},l={RECEIVE_CALL:"RECEIVE_CALL",CALL_SESSION_CREATED:"CALL_SESSION_CREATED",CALL_STARTED:"CALL_STARTED",ACCEPT_CALL:"ACCEPT_CALL",REJECT_CALL:"REJECT_CALL",CALL_DIVS:"CALL_DIVS",END_CALL:"END_CALL",CALL_ENDED:"CALL_ENDED",CALL_PARTICIPANT_RECONNETING:"CALL_PARTICIPANT_RECONNETING",CALL_PARTICIPANT_CONNECTED:"CALL_PARTICIPANT_CONNECTED",CALL_PARTICIPANT_LEFT:"CALL_PARTICIPANT_LEFT",CALL_PARTICIPANT_JOINED:"CALL_PARTICIPANT_JOINED",CALL_PARTICIPANT_REMOVED:"CALL_PARTICIPANT_REMOVED",TERMINATE_CALL:"TERMINATE_CALL",CALL_PARTICIPANT_MUTE:"CALL_PARTICIPANT_MUTE",CALL_PARTICIPANT_UNMUTE:"CALL_PARTICIPANT_UNMUTE",START_RECORDING_CALL:"START_RECORDING_CALL",STOP_RECORDING_CALL:"STOP_RECORDING_CALL",CALL_ERROR:"CALL_ERROR",POOR_VIDEO_CONNECTION:"POOR_VIDEO_CONNECTION",POOR_VIDEO_CONNECTION_RESOLVED:"POOR_VIDEO_CONNECTION_RESOLVED"},a={MESSAGE_NEW:"MESSAGE_NEW",MESSAGE_EDIT:"MESSAGE_EDIT",THREAD_LAST_ACTIVITY_TIME:"THREAD_LAST_ACTIVITY_TIME",THREAD_UNREAD_COUNT_UPDATED:"THREAD_UNREAD_COUNT_UPDATED",MESSAGE_DELIVERY:"MESSAGE_DELIVERY",MESSAGE_SEEN:"MESSAGE_SEEN"},o={TEXT:"TEXT",VOICE:"VOICE",PICTURE:"PICTURE",VIDEO:"VIDEO",SOUND:"SOUND",FILE:"FILE",POD_SPACE_PICTURE:"POD_SPACE_PICTURE",POD_SPACE_VIDEO:"POD_SPACE_VIDEO",POD_SPACE_SOUND:"POD_SPACE_SOUND",POD_SPACE_VOICE:"POD_SPACE_VOICE",POD_SPACE_FILE:"POD_SPACE_FILE",LINK:"LINK",STICKER:"STICKER"},r={VERTICAL:"VERTICAL",PIC_IN_PIC:"PIC_IN_PIC"},c={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3}},957:(e,t,n)=>{n.r(t),n.d(t,{callContainer:()=>s});const s=document.createElement("div");s.style.height="100%",s.innerHTML='\n<style>\n    .call-main-container{\n        width:100%;\n        height:100%;\n        -webkit-backdrop-filter: blur(5px);\n        backdrop-filter: blur(5px);\n        background-color: rgba(0, 0, 0, 0.7);\n        position:relative;\n        display:flex;\n        direction:rtl;\n    }\n    .d-flex-column{\n       flex:1;\n       display:flex !important;\n       flex-direction: column !important;\n    }\n    .call-stream {\n        position:relative\n    }\n    .call-home{\n        align-items: center;\n        justify-content: center;\n    }\n    .poor-connection{\n        position:absolute;\n        top:0px;\n        right:0px;\n        left:0px;\n        width:100%;\n        height:100%;\n        background: gray;\n        align-items: center;\n        justify-content: center;\n        z-index:9999;\n    }\n    .poor-connection h2{\n        font-size: 0.9rem;\n        margin-top:5px;\n    }\n    .socket-status{\n        position:absolute;\n        top:5px;\n        right:5px;\n        background-color: white;\n        height:40px;\n        display:flex;\n        justify-content:center;\n        align-items: center;\n        width:70px;\n    }\n    #vb-call-container{\n        flex:1;\n        width:100%\n    }\n    .wrapper-video{\n        position:relative;\n    }\n\n    .pic-in-pic {\n        position:absolute !important;\n        bottom:80px  !important;\n        right:5px  !important;\n        border: 1px solid white;\n        border-radius:5px ;\n        height:150px  !important;\n        width:100px !important;\n        background-color:whitesmoke;\n        object-fit:cover;\n        z-index:9999;    \n    }\n\n    .video-rotate{\n        transform: rotate(90deg);\n        transform-origin: bottom right;\n        visibility: visible;\n    }\n    .wrapper-video audio{\n        display:none\n    }\n    .full-screen{\n        width: 100% !important;\n        height:100%;\n        object-fit: cover;\n        background-size: cover;\n    }\n\n    .caller-info{\n        padding:5px;\n        font-size: 13px;\n    }\n\n   .call-header{\n     display: flex;\n     position: absolute;\n     top: 0px;\n     width: 100%;\n     height: 50px;\n     align-items: center;\n     padding: 2px;\n     background: gray;\n     opacity: 0.7;\n     z-index:9999;\n   }\n    .color-transparent{\n        background: transparent !important;\n    }\n\n    .footer-call{\n        display:flex;\n        justify-content:center;\n        position:absolute;\n        bottom:0px;\n        width:100%;\n        height:70px;\n        text-align:center\n    }\n    .call-duration{  \n        display:flex;\n        align-items:center;  \n        height:25px;\n        flex: 0 0 70px;\n        color:gray;\n        text-align:center;\n        z-index:9999;\n        background-color:whitesmoke;\n        border: 1px solid whitesmoke;\n        border-radius:20px;  \n    }\n   \n\n    .call-duration lable{\n        padding:5px;  \n        min-width:80px;\n        max-width:95%;\n        font-size:13px;\n       \n    }\n    .call-duration lable span{\n        margin:auto;\n    }\n    .circle-btn{\n        width:55px;\n        height:55px;\n        border-radius: 50%;\n        border: 0px;\n        display:flex;\n        align-items: center;\n        justify-content: center;\n        outline:none;\n    }\n    .margin-5{\n        margin:5px\n    }\n    .margin-8{\n        margin:8px\n    }\n    .msg-badge{\n        text-align:center;\n        height:20px;\n        width:20px;\n        background-color: red;\n        color:white;\n        border-radius:10px;\n        position: absolute;\n        left: 1px;\n        top:1px;\n        z-index:999;\n    }\n    .video{\n        background-color : #ffff;\n        color: white;\n        box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.5);\n    }\n    .end-call ,.pc-end-call{\n        background-color : #ff415d;\n        color: white;\n        box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.5);\n    }\n\n    .cancel-call{\n        background-color : #ff415d;\n        color: white;\n        box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.5);\n    }\n    .bgc-white{\n        background-color : white;\n        color : black;\n    }\n\n    .bgc-green{\n        background-color : green !important;\n        color : white;\n    }\n\n    .messages{\n       background-color : white;\n       width : 100%;\n       display: flex;\n       flex-direction: column;    \n       text-align:right; \n    }\n\n    .messages ul{\n        list-style-type : none;\n        background-color:#f5f5f5;\n        padding: 2px;\n        flex: 1 1 200px !important;\n        overflow :auto;\n    }\n    .messages ul li{\n        \n        color: #455a64;\n        min-height :40px;\n        margin: 5px;\n        display:flex;\n        text-align:right;\n        padding :5px;\n        \n    }\n    \n    .msgitem {\n        padding:5px;\n        border-radius:5px;\n        max-width:50%;\n        min-width:20%;\n        word-wrap: break-word;\n        box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.2), 0 1px 1px 0 rgba(0, 0, 0, 0.19);\n    }\n    .content-left{\n        justify-content:flex-end\n    }\n   \n    .msg-send{\n        background-color:#c8e6c9;\n    }\n    .msg-receive{\n        background-color:#ffff;\n    }\n    .close-bar{ \n        display:flex;\n        align-items:center;\n        padding : 5px;\n        flex: 0 0 30px;\n        text-align : left;\n    }\n    .participant{\n        flex:1;\n        text-align:center;\n    }\n\n    .send-message{\n        background-color:#e1f5fe;\n    }\n\n    .message-input{\n        flex: 0 0 40px;\n        display:flex;\n        align-items:center;\n        justify-content: center;\n        padding: 4px  15px;\n        border: 0.5px solid #eeeeee;\n        margin: 5px;\n        border-radius: 10px;\n    }\n    .close-btn{\n        width:40px;\n        height:40px;\n        border: 0px;\n        background-color:transparent;\n    }\n\n    .input{\n        height:40px;\n        border:none;\n        outline:none;\n        padding:4px;\n        flex:1;\n        text-align:right;\n    }\n    \n    .display-none {\n        display : none\n    }\n    .message {\n        position:relative;\n        background-color:#f5f5f5;\n    }\n    .loading{\n        width: 100px;\n        height: 100px;\n        margin: 20px;\n        \n    }\n    .vb-icon{\n        margin:auto;\n        vertical-align:middle;\n    }\n    .vb-color-white{\n        color:white;\n    }\n    .waiting{\n        font-size:0.9rem;\n    }\n    .poor-connection h2{\n        padding:5px;\n        text-align:center;\n        font-size: 0.8rem !important;\n    }\n</style>\n<div class=\'call-main-container\'>\n    <div class=\'poor-connection display-none\'>\n        <svg width="100" height="100" viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg" stroke="#fff">\n           <g fill="none" fill-rule="evenodd" transform="translate(1 1)" stroke-width="2">\n               <circle cx="22" cy="22" r="6" stroke-opacity="0">\n                   <animate attributeName="r"\n                        begin="1.5s" dur="3s"\n                        values="6;22"\n                        calcMode="linear"\n                        repeatCount="indefinite" />\n                   <animate attributeName="stroke-opacity"\n                        begin="1.5s" dur="3s"\n                        values="1;0" calcMode="linear"\n                        repeatCount="indefinite" />\n                   <animate attributeName="stroke-width"\n                        begin="1.5s" dur="3s"\n                        values="2;0" calcMode="linear"\n                        repeatCount="indefinite" />\n               </circle>\n               <circle cx="22" cy="22" r="6" stroke-opacity="0">\n                   <animate attributeName="r"\n                        begin="3s" dur="3s"\n                        values="6;22"\n                        calcMode="linear"\n                        repeatCount="indefinite" />\n                    <animate attributeName="stroke-opacity"\n                        begin="3s" dur="3s"\n                        values="1;0" calcMode="linear"\n                        repeatCount="indefinite" />\n                       <animate attributeName="stroke-width"\n                        begin="3s" dur="3s"\n                        values="2;0" calcMode="linear"\n                        repeatCount="indefinite" />\n               </circle>\n               <circle cx="22" cy="22" r="8">\n                   <animate attributeName="r"\n                        begin="0s" dur="1.5s"\n                        values="6;1;2;3;4;5;6"\n                        calcMode="linear"\n                        repeatCount="indefinite" />\n               </circle>\n           </g>\n        </svg>\n        <h2 class="vb-color-white"  >ارتباط شبکه ضعیف است.</h2>\n        <h2 class="vb-color-white"  > تصویر بصورت موقت قطع گردید.</h2>\n        <button type=\'button\' class=\'circle-btn margin-8 pc-end-call\' >   \n            <svg xmlns="http://www.w3.org/2000/svg" class=\'vb-icon\' width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>\n        </button>       \n    </div>\n    <div class=\'call-home d-flex-column\'>\n         <div class=\'socket-status\'>\n            <span class=\'socket-status-content\'></span>\n         </div>\n        <svg class=\'loading\' version="1.1" id="L2" xm5lns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">\n            <circle fill="none" stroke="#81c784" stroke-width="4" stroke-miterlimit="10" cx="50" cy="50" r="48"></circle>\n            <line fill="none" stroke-linecap="round" stroke="#81c784" stroke-width="4" stroke-miterlimit="10" x1="50" y1="50" x2="85" y2="50.5">\n                 <animateTransform attributeName="transform" dur="2s" type="rotate" from="0 50 50" to="360 50 50" repeatCount="indefinite"></animateTransform>\n            </line>\n            <line fill="none" stroke-linecap="round" stroke="#81c784" stroke-width="4" stroke-miterlimit="10" x1="50" y1="50" x2="49.5" y2="74">\n                 <animateTransform attributeName="transform" dur="15s" type="rotate" from="0 50 50" to="360 50 50" repeatCount="indefinite"></animateTransform>\n            </line>\n        </svg>\n        <h2 class="vb-color-white waiting" >در حال برقرای تماس منتظر بمانید</h2>\n        <button type=\'button\' class=\'circle-btn margin-8 cancel-call\' >   \n            <svg xmlns="http://www.w3.org/2000/svg" class=\'vb-icon\' width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>\n        </button>\n    </div>\n    <div class=\'call-stream  display-none\'>\n        <div class="call-header vb-color-white">\n            <div class=\'call-duration\'>\n             <lable class=\'display-none\'>\n                <span></span>\n                </lable>\n             </div>\n             <div class="caller-info">\n                <span></span>\n             </div>\n        </div>   \n        <div class=\'wrapper-video\' id=\'vb-call-container\'>\n        </div>\n        \n        <div class=\'footer-call\'>\n            <button type=\'button\' class=\'circle-btn margin-8 message\' >\n                 <span class=\'msg-badge display-none\'></span>\n                 <svg xmlns="http://www.w3.org/2000/svg" class=\'vb-icon\' width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-square"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>\n            </button>\n            <button type="button" class="circle-btn margin-8 mic">\n            <svg xmlns="http://www.w3.org/2000/svg" class="vb-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>\n            </button>  \n            <button type=\'button\' class=\'circle-btn margin-8 end-call\' > \n            <svg xmlns="http://www.w3.org/2000/svg" class=\'vb-icon\'  width="43" height="43" style="">\n                <rect id="backgroundrect" width="100%" height="100%" x="0" y="0" fill="none" stroke="none"/>\n                <defs>\n                        <filter id="9hesgmcrra" width="276.3%" height="276.3%" x="-88.9%" y="-85.7%" filterUnits="objectBoundingBox">\n                         <feOffset dy="2" in="SourceAlpha" result="shadowOffsetOuter1"/>\n                         <feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="12"/>\n                         <feColorMatrix in="shadowBlurOuter1" result="shadowMatrixOuter1" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.357143589 0"/>\n                         <feMerge>\n                      <feMergeNode in="shadowMatrixOuter1"/>\n                         <feMergeNode in="SourceGraphic"/>\n                      </feMerge>\n                     </filter>\n                </defs>\n    \n                <g class="currentLayer" style=""><title>Layer 1</title><g fill="none" fill-rule="evenodd" id="svg_1" class="">\n                    <g fill="#FFF" fill-rule="nonzero" id="svg_2">\n                     <g id="svg_3">\n                     <g filter="url(#9hesgmcrra)" transform="translate(-83,0) translate(239,709) " id="svg_4">\n                    <path d="M-95.48342335510253,-639.5389745788574 c1.06,0 2.048,-0.18800000000000008 2.965,-0.5640000000000003 c0.917,-0.37600000000000017 1.7400000000000002,-0.974 2.47,-1.794 c0.42000000000000015,-0.47900000000000015 0.7600000000000003,-0.991 1.016,-1.538 s0.3850000000000002,-1.1 0.3850000000000002,-1.6580000000000006 c0,-0.41000000000000014 -0.08600000000000005,-0.809 -0.257,-1.196 c-0.17,-0.3880000000000002 -0.455,-0.7180000000000003 -0.8540000000000003,-0.991 l-4.973,-3.521 c-0.3880000000000002,-0.28500000000000014 -0.7440000000000003,-0.49000000000000016 -1.068,-0.6150000000000003 c-0.3250000000000002,-0.126 -0.6360000000000003,-0.18800000000000008 -0.932,-0.18800000000000008 c-0.36400000000000016,0 -0.7200000000000003,0.1 -1.068,0.29900000000000015 c-0.3470000000000003,0.2 -0.7040000000000003,0.48700000000000015 -1.068,0.8630000000000003 l-1.18,1.1280000000000001 c-0.15900000000000009,0.17 -0.36400000000000016,0.256 -0.6150000000000003,0.256 c-0.125,0 -0.24400000000000008,-0.02000000000000001 -0.35800000000000015,-0.06000000000000003 c-0.11400000000000005,-0.04000000000000002 -0.21100000000000008,-0.07700000000000004 -0.29000000000000015,-0.11000000000000004 c-0.514,-0.274 -1.166,-0.7470000000000003 -1.9580000000000002,-1.42 c-0.792,-0.6710000000000006 -1.586,-1.4060000000000001 -2.384,-2.204 c-0.809,-0.797 -1.55,-1.5950000000000002 -2.221,-2.392 c-0.6730000000000006,-0.798 -1.1400000000000001,-1.447 -1.4020000000000001,-1.949 c-0.04500000000000003,-0.09000000000000007 -0.08800000000000006,-0.19000000000000009 -0.128,-0.29900000000000015 c-0.04000000000000002,-0.10800000000000004 -0.06000000000000003,-0.23 -0.06000000000000003,-0.36700000000000016 c0,-0.24000000000000007 0.08600000000000005,-0.43900000000000017 0.257,-0.5980000000000003 l1.145,-1.162 c0.36400000000000016,-0.37600000000000017 0.6490000000000004,-0.7380000000000003 0.8540000000000003,-1.086 c0.20500000000000004,-0.3470000000000003 0.30800000000000016,-0.7090000000000003 0.30800000000000016,-1.085 c0,-0.29600000000000015 -0.06600000000000004,-0.6060000000000003 -0.1970000000000001,-0.931 c-0.13,-0.3250000000000002 -0.3330000000000003,-0.6800000000000006 -0.6070000000000003,-1.068 l-3.503,-4.905 c-0.273,-0.3990000000000003 -0.6100000000000003,-0.6920000000000006 -1.008,-0.8800000000000003 c-0.3990000000000003,-0.18800000000000008 -0.8260000000000003,-0.28200000000000014 -1.282,-0.28200000000000014 c-1.117,0 -2.159,0.467 -3.127,1.401 c-0.798,0.7640000000000003 -1.379,1.6070000000000002 -1.7440000000000002,2.5300000000000002 c-0.36400000000000016,0.922 -0.546,1.9020000000000001 -0.546,2.939 c0,1.56 0.36100000000000015,3.207 1.085,4.939 c0.7230000000000003,1.7320000000000002 1.7120000000000002,3.46 2.965,5.187 c1.2530000000000001,1.726 2.672,3.375 4.255,4.947 c1.561,1.584 3.213,3.008 4.956,4.273 c1.743,1.264 3.487,2.2640000000000002 5.23,2.999 c1.743,0.7350000000000003 3.39,1.102 4.939,1.102 z" transform="rotate(-225 -134.58041381835943,-687.5809936523436) translate(-30.79958152770996,-32.88356399536133) " id="svg_5"/>\n                    </g>\n                  </g>\n                 </g>\n                 </g></g>\n             </svg>\n            </button>\n            <button type=\'button\' class=\'circle-btn margin-8 video\' >\n            <svg xmlns="http://www.w3.org/2000/svg" class="vb-icon" width="36" height="24" style=""><rect id="backgroundrect" width="100%" height="100%" x="0" y="0" fill="none" stroke="none"/>\n                  <defs>\n                      <filter id="m0ghs82paa" width="276.3%" height="276.3%" x="-88.9%" y="-85.7%" filterUnits="objectBoundingBox">\n                         <feOffset dy="2" in="SourceAlpha" result="shadowOffsetOuter1"/>\n                         <feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="12"/>\n                         <feColorMatrix in="shadowBlurOuter1" result="shadowMatrixOuter1" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.357143589 0"/>\n                        <feMerge>\n                        <feMergeNode in="shadowMatrixOuter1"/>\n                        <feMergeNode in="SourceGraphic"/>\n                    </feMerge>\n                </filter>\n                 </defs>           \n                 <g class="currentLayer" style=""><title>Layer 1</title><g fill="none" fill-rule="evenodd" id="svg_1" class="">\n                     <g fill="#252525" fill-rule="nonzero" id="svg_2">\n                         <g id="svg_3">\n                        <g filter="url(#m0ghs82paa)" transform="translate(-83,0) translate(136,709) " id="svg_4">\n                            <path d="M-31.76600030517578,-684.7960087890625 c3.531,0 5.625,-2.047 5.625,-5.579 v-2.25 l5.6880000000000015,4.782 c0.5780000000000002,0.4840000000000001 1.218,0.812 1.828,0.812 c1.218,0 2.03,-0.906 2.03,-2.234 V-704.5310087890625 c0,-1.328 -0.812,-2.234 -2.03,-2.234 c-0.6100000000000002,0 -1.25,0.3280000000000001 -1.828,0.812 l-5.6880000000000015,4.766 v-2.235 c0,-3.5460000000000003 -2.094,-5.578 -5.625,-5.578 h-15.61 c-3.39,0 -5.6240000000000006,2.032 -5.6240000000000006,5.578 V-690.3740087890625 c0,3.532 2.093,5.578 5.625,5.578 h15.61 zm-0.3900000000000001,-2.016 H-46.98600030517578 c-2.468,0 -3.8600000000000003,-1.2810000000000001 -3.8600000000000003,-3.89 V-703.0940087890625 c0,-2.6100000000000003 1.3920000000000001,-3.891 3.8600000000000003,-3.891 h14.828 c2.47,0 3.8600000000000003,1.2810000000000001 3.8600000000000003,3.89 v12.391 c0,2.6100000000000003 -1.3900000000000001,3.89 -3.8600000000000003,3.89 zm13.187,-2.625 c-0.15600000000000006,0 -0.281,-0.09400000000000006 -0.453,-0.21900000000000006 l-6.719,-5.516 v-3.468 l6.719,-5.5 c0.17200000000000001,-0.14 0.2970000000000001,-0.21900000000000006 0.453,-0.21900000000000006 c0.203,0 0.2970000000000001,0.15600000000000006 0.2970000000000001,0.4220000000000001 v14.078 c0,0.266 -0.09400000000000006,0.4220000000000001 -0.2970000000000001,0.4220000000000001 z" id="svg_5"/>\n                        </g>\n                         </g>\n                       </g>\n                    </g></g></svg>\n            </button>\n        </div>\n    </div>\n    <div class=\'messages  display-none\'>\n        <div class=\'close-bar\'>\n            <span class="participant"></span>\n            <button type=\'button\' class=\'bgc-white close-btn\' >\n                <svg\n                    xmlns="http://www.w3.org/2000/svg"\n                     width="24"\n                     height="24"\n                    viewBox="0 0 24 24"\n                    fill="none"\n                    stroke="currentColor"\n                     stroke-width="2"\n                     stroke-linecap="round"\n                     stroke-linejoin="round"\n                     class="vb-icon"\n                     >\n                    <line x1="19" y1="12" x2="5" y2="12" />\n                    <polyline points="12 19 5 12 12 5" />\n                </svg>\n            </button>\n        </div>\n        <ul class=\'messages-list\'>\n        </ul>\n        <div class=\'message-input\'>\n            <button type=\'button\' class=\'bgc-green circle-btn send-message\' >\n                 <svg\n                 class="vb-icon"\n                xmlns="http://www.w3.org/2000/svg"\n                width="24"\n                height="24"\n                viewBox="0 0 24 24"\n                fill="none"\n                stroke="currentColor"\n                stroke-width="2"\n                 stroke-linecap="round"\n                stroke-linejoin="round">\n               <line x1="5" y1="12" x2="19" y2="12" />\n               <polyline points="12 5 19 12 12 19" />\n                </svg>\n            </button>\n            <input type=\'text\' class="input" placeholder="متن پیام" />\n            \n        </div>\n    </div>\n</div>\n'}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var l=t[s]={exports:{}};return e[s](l,l.exports,n),l.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{n.d(s,{default:()=>h});var{callStatus:e,callType:t,callEvents:i,messageEvents:l,messageType:a,callDisplayType:o,socketStateType:r}=n(887),{callContainer:c}=n(957);class h{constructor(n,s){this.hostId=n,this.threadId=0,this.autoAnswer=!0,this.callStatus=e.DEFAULT,this.callId=0,this.callType=t.VIDEO,this.hostElement={},this.badgeElement={},this.callElement={},this.newMessage=0,this.isCamOn=!0,this.isMicOn=!0,this.options=s,this.endCallback=s.endCallback,this.cancelCallback=s.cancelCallback,this.inCall=!1,this.isDisposed=!1,this.totalTime=0,this.callDurationInterval=null,this.isHistoryLoaded=!1,this.currentUser=s.userInfo,this.userIsCustomer=s.userIsCustomer,this.socektStatus={},this.receiveCallTimeout=this.setCallTimeout(s.receiveCallTimeout),this.callStartedTimeout={}}setCallTimeout(e){return e||(e=1e4),setTimeout((()=>{this.options.timeoutCallback&&this.options.timeoutCallback(),this.cancelCall()}),e)}setChatAgent(e){this.chatAgent=e,this.callListener=this.chatAgent.on("callEvents",(e=>this.call_eventHandler(e))),this.messageListener=this.chatAgent.on("messageEvents",(e=>this.message_eventHandler(e))),this.chatStateListener=this.chatAgent.on("chatState",(e=>this.chatState_eventHandler(e)))}initializeView(){this.hostElement=document.getElementById(this.hostId),this.hostElement.appendChild(c.cloneNode(!0)),this.hostElement.querySelector(".mic").addEventListener("click",(e=>this.toggleMic(e))),this.hostElement.querySelector(".video").addEventListener("click",(e=>this.toggleCam(e))),this.hostElement.querySelector(".end-call").addEventListener("click",(()=>this.endCall())),this.hostElement.querySelector(".pc-end-call").addEventListener("click",(()=>this.endCall())),this.hostElement.querySelector(".cancel-call").addEventListener("click",(()=>this.cancelCall())),this.hostElement.querySelector(".close-btn").addEventListener("click",(()=>this.closeMsg())),this.hostElement.querySelector(".message").addEventListener("click",(()=>this.openMessages())),this.hostElement.querySelector(".send-message").addEventListener("click",(()=>this.sendMsge(this.hostElement.querySelector(".input").value))),this.badgeElement=this.hostElement.querySelector(".msg-badge"),this.callElement=this.hostElement.querySelector(".wrapper-video"),this.hostElement.querySelector(".input").addEventListener("keyup",(e=>{13===e.keyCode&&(e.preventDefault(),this.hostElement.querySelector(".send-message").click())})),this._inputMessage=this.hostElement.querySelector(".input"),this.messageList=this.hostElement.querySelector(".messages-list"),this._clearCallDiv(),this.messageList.scrollTop=this.messageList.scrollHeight,this.options.headerText?this.hostElement.querySelector(".caller-info span").innerHTML=this.options.headerText:this.hostElement.querySelector(".call-header").classList.add("color-transparent"),this.options.waitingText&&(this.hostElement.querySelector(".waiting").innerHTML=this.options.waitingText),this.socektStatus=this.hostElement.querySelector(".socket-status-content")}openMessages(){this.hostElement.querySelector(".call-stream").classList.remove("d-flex-column"),this.hostElement.querySelector(".call-stream").classList.add("display-none"),this.hostElement.querySelector(".messages").classList.remove("display-none"),this.hostElement.querySelector(".messages").classList.add("d-flex-column"),this.callStatus=e.MESSAGE,0!==this.newMessage&&this.badgeElement.classList.add("display-none"),this.newMessage=0,this.hostElement.querySelector(".input").focus(),this.messageList.scrollTop=this.messageList.scrollHeight}sendMsge(e){if(""!=(e=e.trim())){var t={threadId:this.threadId,textMessage:e,messageType:a.TEXT};this.chatAgent.sendTextMessage(t,{onSent:e=>{this._inputMessage.value=""},onDeliver:e=>{this.log(e.uniqueId+" \t has been Delivered!")},onSeen:e=>{this.log(e.uniqueId+" \t has been Seen!")}})}}addMessageToList(e,t,n){let s=document.createElement("li"),i=document.createElement("span"),l=document.createElement("div"),a=document.createElement("div"),o=document.createElement("br");l.classList.add("msgitem"),t==this.currentUser.id?l.classList.add("msg-send"):(s.classList.add("content-left"),l.classList.add("msg-receive")),i.innerHTML=e,l.appendChild(i),l.appendChild(o);let r=new Date(n);a.innerHTML=(r.getHours()<=9?"0"+r.getHours():r.getHours())+":"+(r.getMinutes()<=9?"0"+r.getMinutes():r.getMinutes()),l.appendChild(a),s.appendChild(l),this.hostElement.querySelector(".messages-list").append(s)}getHistory(){if(!this.isHistoryLoaded){var e={threadId:this.threadId,count:50,offset:0,order:"DESC",messageType:"TEXT"};this.chatAgent.getHistory(e,(e=>{this.log("load history"),e.hasError?console.log(e.errorMessage):(this.isHistoryLoaded=!0,e.result.history.reverse().forEach((e=>{this.addMessageToList(`\n                         <span>${e.message}</span>`,e.participant.id,e.timeMiliSeconds)})))}))}}closeMsg(){this.hostElement.querySelector(".input").value="",this.hostElement.querySelector(".call-stream").classList.remove("display-none"),this.hostElement.querySelector(".call-stream").classList.add("d-flex-column"),this.hostElement.querySelector(".messages").classList.remove("d-flex-column"),this.hostElement.querySelector(".messages").classList.add("display-none"),this.callStatus=e.CALLSTREAM}render(){this.initializeView()}call(t){this.threadId=t.threadId,this.chatAgent&&(this.chatAgent.startCall(t),this.callStatus=e.CALLING)}getThreadParticipant(e){if(this.participant)return;let t={threadId:e};this.chatAgent.getThreadParticipants(t,(e=>{this.participant=e.result.participants.find((e=>e.id!==this.currentUser.id)),this.hostElement.querySelector(".participant").innerHTML=this.participant.name}))}message_eventHandler(e){var t=e.type,n=e.result.message;switch(this.log("message event!"),14==n.messageType&&0===this.threadId&&(this.threadId=n.threadId),this.getThreadParticipant(this.threadId),this.getHistory(),t){case l.MESSAGE_NEW:this.log("new message received!!"),this.log(e),n.message&&n.threadId==this.threadId&&(this.increementBadge(),this.addMessageToList(`                 \n                             <span>${n.message}</span>`,n.participant.id,n.timeMiliSeconds),this.messageList.scrollTop=this.messageList.scrollHeight);case l.MESSAGE_EDIT:case l.MESSAGE_DELIVERY:case l.MESSAGE_SEEN:}}increementBadge(){this.callStatus!=e.MESSAGE&&(0==this.newMessage&&this.badgeElement.classList.remove("display-none"),this.newMessage+=1,this.badgeElement.innerHTML=this.newMessage)}chatState_eventHandler(e){let t="";switch(e.socketState){case r.CONNECTING:t="در حال اتصال";break;case r.OPEN:t="آنلاین";break;case r.CLOSED:t="آفلاین";break;case r.CLOSING:t="در حال قطع شدن"}this.socektStatus.innerHTML=t}call_eventHandler(t){switch(this.log("call event occured!!"),this.log(t),t.type){case i.RECEIVE_CALL:clearTimeout(this.receiveCallTimeout),this.call_received(t.result.callId),this.callId=t.result.callId,this._initInterval(),this._clearCallDiv(),this.log("rec callId:"+this.callId),this.callStartedTimeout=this.setCallTimeout(this.options.callStartedTimeout),this.options.receiveCallback&&this.options.receiveCallback(t);break;case i.CALL_SESSION_CREATED:clearTimeout(this.receiveCallTimeout),this.log("call session created!!!"),this._clearCallDiv(),this.callId=t.result.callId,this.log("session callId:"+this.callId),this.callStartedTimeout=this.setCallTimeout(this.options.callStartedTimeout);break;case i.CALL_STARTED:clearTimeout(this.callStartedTimeout),clearTimeout(this.receiveCallTimeout),this.log("call sarted!!!"),this._initInterval(),this.callElement.innerHTML="",this.callStatus=e.CALLSTREAM,this._changeCallStatus(e.CALLSTREAM);break;case i.CALL_ENDED:this.log("call ended!!!"),this._clearCallDiv(),clearInterval(this.callDurationInterval);break;case i.POOR_VIDEO_CONNECTION:this.poorConnection();break;case i.POOR_VIDEO_CONNECTION_RESOLVED:this.poorConnectionResolved();break;case i.CALL_DIVS:const{uiLocalVideo:n,uiLocalAudio:s,uiRemoteElements:l}=t.result;n.classList.add("pic-in-pic"),l[0].uiRemoteVideo.classList.add("full-screen");case i.CALL_ERROR:}}call_received(t){this.chatAgent.acceptCall({callId:t,video:!0,mute:!1},(e=>{this.log("call accepted!")})),this.callStatus=e.CALLSTREAM}_changeCallStatus(t){t==e.CALLSTREAM?(this.hostElement.querySelector(".call-stream").classList.remove("display-none"),this.hostElement.querySelector(".call-stream").classList.add("d-flex-column"),this.hostElement.querySelector(".call-home").classList.remove("d-flex-column"),this.hostElement.querySelector(".call-home").classList.add("display-none"),this.hostElement.querySelector(".poor-connection").classList.remove("d-flex-column"),this.hostElement.querySelector(".poor-connection").classList.add("display-none")):t==e.POOR_CONNECTION&&(this.hostElement.querySelector(".call-home").classList.remove("d-flex-column"),this.hostElement.querySelector(".call-home").classList.add("display-none"),this.hostElement.querySelector(".poor-connection").classList.remove("display-none"),this.hostElement.querySelector(".poor-connection").classList.add("d-flex-column"),this.hostElement.querySelector(".call-stream").classList.remove("d-flex-column"),this.hostElement.querySelector(".call-stream").classList.add("display-none"))}poorConnection(){this.chatAgent.pauseCamera(),this.callStatus==e.CALLSTREAM?(this.hostElement.querySelector(".call-stream").classList.remove("d-flex-column"),this.hostElement.querySelector(".call-stream").classList.add("display-none")):this.callStatus==e.MESSAGE&&(this.hostElement.querySelector(".messages").classList.remove("d-flex-column"),this.hostElement.querySelector(".messages").classList.add("display-none")),this.hostElement.querySelector(".poor-connection").classList.remove("display-none"),this.hostElement.querySelector(".poor-connection").classList.add("d-flex-column")}poorConnectionResolved(){this.chatAgent.resumeCamera(),this.callStatus==e.CALLSTREAM?(this.hostElement.querySelector(".call-stream").classList.remove("display-none"),this.hostElement.querySelector(".call-stream").classList.add("d-flex-column")):this.callStatus==e.MESSAGE&&(this.hostElement.querySelector(".messages").classList.remove("display-none"),this.hostElement.querySelector(".messages").classList.add("d-flex-column")),this.hostElement.querySelector(".poor-connection").classList.remove("d-flex-column"),this.hostElement.querySelector(".poor-connection").classList.add("display-none")}toggleCam(e){if(0==this.callId||!this.callId)return;this.isCamOn=!this.isCamOn;let t=this.hostElement.querySelector(".video");this.isCamOn?(t.innerHTML='\n                    <svg xmlns="http://www.w3.org/2000/svg" class="vb-icon" width="36" height="24" style=""><rect id="backgroundrect" width="100%" height="100%" x="0" y="0" fill="none" stroke="none"/>\n                        <defs>\n                            <filter id="m0ghs82paa" width="276.3%" height="276.3%" x="-88.9%" y="-85.7%" filterUnits="objectBoundingBox">\n                               <feOffset dy="2" in="SourceAlpha" result="shadowOffsetOuter1"/>\n                               <feGaussianBlur in="shadowOffsetOuter1" result="shadowBlurOuter1" stdDeviation="12"/>\n                               <feColorMatrix in="shadowBlurOuter1" result="shadowMatrixOuter1" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.357143589 0"/>\n                              <feMerge>\n                              <feMergeNode in="shadowMatrixOuter1"/>\n                              <feMergeNode in="SourceGraphic"/>\n                          </feMerge>\n                      </filter>\n                       </defs>           \n                        <g class="currentLayer" style=""><title>Layer 1</title><g fill="none" fill-rule="evenodd" id="svg_1" class="">\n                           <g fill="#252525" fill-rule="nonzero" id="svg_2">\n                               <g id="svg_3">\n                              <g filter="url(#m0ghs82paa)" transform="translate(-83,0) translate(136,709) " id="svg_4">\n                                  <path d="M-31.76600030517578,-684.7960087890625 c3.531,0 5.625,-2.047 5.625,-5.579 v-2.25 l5.6880000000000015,4.782 c0.5780000000000002,0.4840000000000001 1.218,0.812 1.828,0.812 c1.218,0 2.03,-0.906 2.03,-2.234 V-704.5310087890625 c0,-1.328 -0.812,-2.234 -2.03,-2.234 c-0.6100000000000002,0 -1.25,0.3280000000000001 -1.828,0.812 l-5.6880000000000015,4.766 v-2.235 c0,-3.5460000000000003 -2.094,-5.578 -5.625,-5.578 h-15.61 c-3.39,0 -5.6240000000000006,2.032 -5.6240000000000006,5.578 V-690.3740087890625 c0,3.532 2.093,5.578 5.625,5.578 h15.61 zm-0.3900000000000001,-2.016 H-46.98600030517578 c-2.468,0 -3.8600000000000003,-1.2810000000000001 -3.8600000000000003,-3.89 V-703.0940087890625 c0,-2.6100000000000003 1.3920000000000001,-3.891 3.8600000000000003,-3.891 h14.828 c2.47,0 3.8600000000000003,1.2810000000000001 3.8600000000000003,3.89 v12.391 c0,2.6100000000000003 -1.3900000000000001,3.89 -3.8600000000000003,3.89 zm13.187,-2.625 c-0.15600000000000006,0 -0.281,-0.09400000000000006 -0.453,-0.21900000000000006 l-6.719,-5.516 v-3.468 l6.719,-5.5 c0.17200000000000001,-0.14 0.2970000000000001,-0.21900000000000006 0.453,-0.21900000000000006 c0.203,0 0.2970000000000001,0.15600000000000006 0.2970000000000001,0.4220000000000001 v14.078 c0,0.266 -0.09400000000000006,0.4220000000000001 -0.2970000000000001,0.4220000000000001 z" id="svg_5"/>\n                              </g>\n                               </g>\n                             </g>\n                            </g>\n                        </g>\n                    </svg>',this.chatAgent.resumeCamera()):(t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="vb-icon" width="24" height="24" viewBox="0 0 24 24" fill="none"stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"> <path d="M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10" /> <line x1="1" y1="1" x2="23" y2="23" /> </svg>',this.chatAgent.pauseCamera())}toggleMic(e){this.isMicOn=!this.isMicOn;let t=this.hostElement.querySelector(".mic");this.isMicOn?(t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="vb-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>',this.chatAgent.resumeMice()):(t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="vb-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mic-off"><line x1="1" y1="1" x2="23" y2="23"></line><path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"></path><path d="M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>',this.chatAgent.pauseMice())}endCall(){this.log("callId:"+this.callId),this.chatAgent.endCall({callId:this.callId},(e=>{})),this.endCallback&&this.endCallback(),this.dispose()}cancelCall(){this.callId&&this.chatAgent.endCall({callId:this.callId},(function(e){console.log({res:e})})),this.cancelCallback&&this.cancelCallback(),this.dispose()}dispose(){this._clearCallDiv(),!this.isDisposed&&this.chatAgent&&(this.callId=0,this.threadId=0,this.chatAgent.off("callEvents",this.callListener),this.chatAgent.off("messageEvents",this.messageListener),this.chatAgent.off("chatState",this.chatStateListener),this.isDisposed=!0,clearInterval(this.callDurationInterval),clearTimeout(this.receiveCallTimeout),clearTimeout(this.callStartedTimeout))}_milisecondToTime(e){const t=e=>e<10?`0${e}`:e,n=t(Math.floor(e/36e5%60)),s=t(Math.floor(e/6e4%60)),i=t(Math.floor(e/1e3%60));return`${parseInt(n)?`${n}:`:""}${s}:${i}`}_initInterval(){null==this.callDurationInterval&&(this.totalTime=0,this.callDurationInterval=setInterval((()=>{this.totalTime+=1,this.hostElement.querySelector(".call-duration lable").classList.remove("display-none"),this.hostElement.querySelector(".call-duration lable span").innerHTML=this._milisecondToTime(1e3*this.totalTime)}),1e3))}_clearCallDiv(){this.hostElement.querySelector("#vb-call-container").innerHTML=""}log(e){this.options.consoleLogging&&console.log(e)}}})(),s.default})()}));